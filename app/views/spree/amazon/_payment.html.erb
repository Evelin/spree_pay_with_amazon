<%# %>
<%# Amazon Payments - Login and Pay for Spree Commerce %>
<%# %>
<%# @category    Amazon %>
<%# @package     Amazon_Payments %>
<%# @copyright   Copyright (c) 2014 Amazon.com %>
<%# @license     http://opensource.org/licenses/Apache-2.0  Apache License, Version 2.0 %>
<%# %>
new OffAmazonPayments.Widgets.Wallet({
  sellerId: '<%= Spree::Config[:amazon_merchant_id] %>',
  onPaymentSelect: function(orderReference) {
    jQuery.ajax({
      type: "POST",
      url: "<%= payment_amazon_order_path %>",
      data: {"order_reference": order_reference}
    })
    $.ajax({
      type: "GET",
      url: "<%= get_selected_address_amazon_order_path  %>",
      data: {"order_reference": order_reference}
    }).done(function(data){
      currentShippingCountryISO = data.selectedCountryISO
      currentShippingStateName = data.selectedStateName
    })
    $('#continue_to_delivery').click();
  },
  design: {
    designMode: 'responsive'
  },
  onError: function(error) {
    // your error handling code
  }
}).bind("walletWidgetDiv");
